editFile = (arr) => {
    console.log(arr);

    // Remove element if it's exist
    let isModalExist = document.getElementById('edit-file');
    if (isModalExist != undefined)
        isModalExist.remove();    

    // Function to flexible add inline styles
    function setStyle(object, propertyObject) {
        for (let property in propertyObject)
            object.style[property] = propertyObject[property];
    }

    // Create modal window
    let modalWindow = document.createElement('div');
    modalWindow.setAttribute('id', 'edit-file');

    // Create form and elements for it
    let form = document.createElement('form');
    form.method = 'POST';
    form.action = `/profile/edit/file/${arr._id}`;

    // Properties for item name w/ label for it
    let itemName = document.createElement('input');
    itemName.value = arr.name || '';
    itemName.name = 'name';
    itemName.placeholder = 'Укажите имя файла';
    // Label
    let labelName = document.createElement('label');
    labelName.innerHTML = 'Имя файла: ';
    labelName.appendChild(itemName);
    form.appendChild(labelName);

    // Properties for item kind w/ label for it
    let itemKind = document.createElement('select');
    let optionsItemKind = ['Грамота', 'Благодарственное письмо', 'Сертификат'];
    optionsItemKind.forEach(function(element, key) {
        if (element === arr.kind){
            itemKind[key] = new Option(element, key, true);
        }
        itemKind[key] = new Option(element, key);
    });
    itemKind.name = 'kind';
    // Label
    let labelKind = document.createElement('label');
    labelKind.innerHTML = 'Тип награды: ';
    labelKind.appendChild(itemKind);
    form.appendChild(labelKind);

    // Properties for item mark w/ label for it
    let itemMark = document.createElement('input');
    itemMark.value = arr.mark || '';
    itemMark.placeholder = 'Оценка';
    itemMark.name = 'mark';
    // Label
    let labelMark = document.createElement('label');
    labelMark.innerHTML = 'Оценка: ';
    labelMark.appendChild(itemMark);
    form.appendChild(labelMark);

    // Properties for item subject w/ label for it
    let itemSubject = document.createElement('input');
    itemSubject.value = arr.subject || '';
    itemSubject.placeholder = 'Укажите тему выступления';
    itemSubject.name = 'subject';
    // Label
    let labelSubject = document.createElement('label');
    labelSubject.innerHTML = 'Тема выступления: ';
    labelSubject.appendChild(itemSubject);
    form.appendChild(labelSubject);

    // Properties for item place w/ label for it
    let itemPlace = document.createElement('input');
    itemPlace.value = arr.place || '';
    itemPlace.placeholder = 'Укажите место, где проходило мероприятие';
    itemPlace.name = 'place';
    // Label
    let labelPlace = document.createElement('label');
    labelPlace.innerHTML = 'Место мероприятия: ';
    labelPlace.appendChild(itemPlace);
    form.appendChild(labelPlace);

    // Properties for item date w/ label for it
    let itemDate = document.createElement('input');
    itemDate.value = arr.date || '';
    itemDate.placeholder = 'Укажите дату участия в мероприятии';
    itemDate.name = 'date';
    // Label
    let labelDate = document.createElement('label');
    labelDate.innerHTML = 'Дата участия: ';
    labelDate.appendChild(itemDate);
    form.appendChild(labelDate);

    // Properties for submit button w/ label for it
    let submitModal = document.createElement('button');
    submitModal.classList.add('edit-file-submit');
    submitModal.innerHTML = 'Сохранить изменения';
    submitModal.value = 'submit';
    submitModal.onclick = function() {
        this.form.submit();
    }
    form.appendChild(submitModal);

    // Close modal window element
    let closeSpan = document.createElement('span');
    closeSpan.innerHTML = '&times;';
    closeSpan.classList.add('modal-close');
    // Close modal window and return back URL
    closeSpan.onclick = function() {
        modalWindow.remove();
        window.history.replaceState("", document.title, window.location.pathname);
    };

    // Close modal window when user clicks outside the modal workspace
    window.onclick = event => {
        if (event.target == modalWindow) {
            modalWindow.remove();
            window.history.replaceState("", document.title, window.location.pathname);
        }
    }

    // Properties for modal window wrapper
    let modalWindowWrapper = document.createElement('div');
    modalWindowWrapper.classList.add('modal-wrapper');
    modalWindowWrapper.appendChild(closeSpan);
    modalWindowWrapper.appendChild(form);
    // Add wrapper to the modal window
    modalWindow.appendChild(modalWindowWrapper);

    // Add modal window to the table
    document.getElementById('files').appendChild(modalWindow);

}
window.onload = function() {
    let filter = () => {
        // Search input for each field (mark. subject, place, date)
        let searchKind = document.getElementById('search-kind');
        let searchMark = document.getElementById('search-mark');
        let searchSubject = document.getElementById('search-subject');
        let searchPlace = document.getElementById('search-place');
        let searchDate = document.getElementById('search-date');

        // All items with data-item attribute
        let dataItems = document.querySelectorAll('[data-item]');

        // Array for storing elements in the order (1st elem =  all elements with [data-item = '1'] etc...)
        let itemsArray = [];
        // Assign each element to array
        dataItems.forEach(item => {
            let attr = item.getAttribute('data-item');
            if (itemsArray[attr] == undefined)
                itemsArray[attr] = [];
            itemsArray[attr].push(item);
        });

        // Add event 'keyup' for search kind
        searchKind.addEventListener('keyup', function() {
            console.log('key is pressed');
            let itemParam = searchKind.value.toLowerCase();
            searchHandler('.item-file-kind', itemsArray, itemParam);
        })

        // Add event 'keyup' for search mark
        searchMark.addEventListener('keyup', function() {
            console.log('key is pressed');
            let itemParam = searchMark.value.toLowerCase();
            searchHandler('.item-file-mark', itemsArray, itemParam);
        });

        // Add event 'keyup' for search subject
        searchSubject.addEventListener('keyup', function() {
            console.log('key is pressed');
            let itemParam = searchSubject.value.toLowerCase();
            searchHandler('.item-file-subject', itemsArray, itemParam);
        });

        // Add event 'keyup' for search place
        searchPlace.addEventListener('keyup', function() {
            console.log('key is pressed');
            let itemParam = searchPlace.value.toLowerCase();
            searchHandler('.item-file-place', itemsArray, itemParam);
        });

        // Add event 'keyup' for search date
        searchDate.addEventListener('keyup', function() {
            console.log('key is pressed');
            let itemParam = searchDate.value.toLowerCase();
            searchHandler('.item-file-date', itemsArray, itemParam);
        });
    };

    filter();

    // Function to handle search
    let searchHandler = (itemClass, itemsArray, key) => {

        // Create new array with the same elements from different data-item
        let sortItems = itemsArray.map(el => {
            let newItem;
            for (const elem of el) {
                if(elem.matches(itemClass))
                    newItem = elem;
            }
            return newItem;
        });
        
        // Check if input value is equivalent to one of the elements
        sortItems.forEach(elem => {
            // Take value of element (remember, we have span inside main div,
            // that's why we use children[0])
            let childItem = elem.children[0].innerHTML;
            if(childItem.toLowerCase().indexOf(key) > -1) {
                let itemData = elem.getAttribute('data-item');
                itemsArray[itemData].forEach(el => {
                    el.style.display = '';
                });
            } else {
                let itemData = elem.getAttribute('data-item');
                itemsArray[itemData].forEach(el => {
                    el.style.display = 'none';
                });
            }
        });

    };

}
const modalHandler = (actionId) => {

    let modalWindow = document.getElementById('modal');
    let actionContent = document.getElementsByClassName('actions__content');
    let closeModal = document.getElementsByClassName("modal__close")[0];
    let linkModal = document.getElementsByClassName("actions__link");

    // Close the modal window when button (span) is pressed
    closeModal.onclick = () => {
        document.getElementById(actionId).style.display = "none";
        modalWindow.style.display = "none";
        window.history.replaceState("", document.title, window.location.pathname);
        // Prevents the loses of scroll position when modal is open and the body set to be fixed
        const scrollY = document.body.style.top;
        document.body.style.position = '';
        document.body.style.top = '';
        window.scrollTo(0, parseInt(scrollY || '0') * -1);
    }

    // Close the modal window when user clicks outside the modal window
    window.onclick = event => {
        if (event.target == modalWindow) {
            document.getElementById(actionId).style.display = "none";
            modalWindow.style.display = "none";
            window.history.replaceState("", document.title, window.location.pathname);
            // Prevents the loses of scroll position when modal is open and the body set to be fixed
            const scrollY = document.body.style.top;
            document.body.style.position = '';
            document.body.style.top = '';
            window.scrollTo(0, parseInt(scrollY || '0') * -1);
        }
    }

    // Disable all modal content tabs
    for (let item of actionContent){
        item.style.display = "none";
    }

    // Show the modal window
    modalWindow.style.display = "flex";
    modalWindow.style.flexDirection = "column";
    document.body.style.position = 'fixed';
    document.body.style.top = `${window.scrollY}px`;

    // Display content for modal window
    switch(actionId) {
        case "login":
            document.getElementById(actionId).style.display = "flex";
            document.getElementById(actionId).style.flexDirection = "column";
            linkModal.item(0).classList.add("actions__link-active");
            if (linkModal.item(1).classList.contains("actions__link-active"))
                linkModal.item(1).classList.remove("actions__link-active");
            break;
        case "register":
            document.getElementById(actionId).style.display = "flex";
            document.getElementById(actionId).style.flexDirection = "column";
            linkModal.item(1).classList.add("actions__link-active");
            if (linkModal.item(0).classList.contains("actions__link-active"))
                linkModal.item(0).classList.remove("actions__link-active");
            break;
    }
}
window.onload = function() {
    document.getElementById('avatar-upload').onchange = () => {
        this.form.submit();
    }
}
window.onload = function() {
    let slides = document.getElementsByClassName('slider__item');
    let slideActive = 0;
    let buttons = document.getElementsByClassName('slider__button');

    // Make visible 1st item and disable 'previous' button
    slides[slideActive].classList.add('slider__item--isVisible');
    buttons[0].classList.add('slider__button--disabled');

    // Change slide
    nextSlide = n => {
        // Disable activated slide
        slides[slideActive].classList.toggle('slider__item--isVisible');
        slideActive += n;
        // If next slide will be 1st, then disable 'previous' button 
        if (slideActive == 0) buttons[0].classList.toggle('slider__button--disabled');
        // If next slide will be last, then disable 'next' button
        if (slideActive == 2) buttons[1].classList.toggle('slider__button--disabled');
        // Some stupid code to handle buttons for 1st slide
        if (slideActive == 1) {
            if (buttons[0].classList.contains('slider__button--disabled'))
                buttons[0].classList.toggle('slider__button--disabled');
            if (buttons[1].classList.contains('slider__button--disabled'))
                buttons[1].classList.toggle('slider__button--disabled');
        }
        // Make the next slide visible
        slides[slideActive].classList.toggle('slider__item--isVisible');
    }
}